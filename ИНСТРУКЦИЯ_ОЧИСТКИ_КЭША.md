# üîß –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **92 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è**, –Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **107**.

### –ü—Ä–∏—á–∏–Ω–∞:
1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏ –º–æ–¥—É–ª—è** - —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö `let allExercises` –∏ `let isLoaded`
2. **HTTP –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞** - API –≤–æ–∑–≤—Ä–∞—â–∞–ª `Cache-Control: public, max-age=3600` (–∫—ç—à –Ω–∞ 1 —á–∞—Å)
3. **–°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ** - –¥–∞–∂–µ –ø–æ—Å–ª–µ hard reload –¥–∞–Ω–Ω—ã–µ –º–æ–≥–ª–∏ –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è

---

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. `lib/exercises-data.ts`
**–ë—ã–ª–æ:**
```typescript
let allExercises: Exercise[] = [];
let isLoaded = false;

async function loadExercises() {
  if (isLoaded) return allExercises; // ‚ùå –ö—ç—à!
  // ...
}
```

**–°—Ç–∞–ª–æ:**
```typescript
async function loadExercises() {
  // –ö–∞–∂–¥—ã–π —Ä–∞–∑ –∑–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–Ω–æ–≤–æ
  const response = await fetch('/api/exercises/translated', {
    cache: 'no-store', // ‚úÖ –ë–µ–∑ –∫—ç—à–∞!
    headers: {
      'Cache-Control': 'no-cache',
      'Pragma': 'no-cache',
    },
  });
  // ...
}
```

### 2. `app/api/exercises/translated/route.ts`
**–ë—ã–ª–æ:**
```typescript
return NextResponse.json(exercises, {
  headers: {
    'Cache-Control': 'public, max-age=3600, s-maxage=86400', // ‚ùå –ö—ç—à –Ω–∞ 1 —á–∞—Å!
  },
});
```

**–°—Ç–∞–ª–æ:**
```typescript
return NextResponse.json(exercises, {
  headers: {
    'Cache-Control': 'no-store, no-cache, must-revalidate, proxy-revalidate', // ‚úÖ –ë–µ–∑ –∫—ç—à–∞!
    'Pragma': 'no-cache',
    'Expires': '0',
  },
});
```

---

## üöÄ –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

```bash
cd ~/webapptraining
git pull origin main
rm -rf .next
npm run build
pm2 restart all
```

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –Ω—É–∂–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å–∞–π—Ç–∞, **–Ω–µ –ø—Ä–æ—Å—Ç–æ hard reload!**

### –°–ø–æ—Å–æ–± 1: –û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å–∞–π—Ç–∞ (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –û—Ç–∫—Ä—ã—Ç—å DevTools (`F12`)
2. **Application** ‚Üí **Storage** ‚Üí **Clear site data**
3. –ù–∞–∂–∞—Ç—å **"Clear site data"**
4. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É (`F5`)

![Clear site data](https://i.imgur.com/screenshot.png)

### –°–ø–æ—Å–æ–± 2: Hard Reload (–º–æ–∂–µ—Ç –Ω–µ –ø–æ–º–æ—á—å)

- **Chrome/Safari**: `Cmd + Shift + R` (macOS) –∏–ª–∏ `Ctrl + Shift + R` (Windows)
- **Firefox**: `Cmd + Shift + R` (macOS) –∏–ª–∏ `Ctrl + F5` (Windows)

### –°–ø–æ—Å–æ–± 3: –ò–Ω–∫–æ–≥–Ω–∏—Ç–æ (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏)

- –û—Ç–∫—Ä—ã—Ç—å —Å–∞–π—Ç –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è 92 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è

### –°–ø–æ—Å–æ–± 4: –†—É—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**Chrome:**
1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
2. –û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä–∞
3. –î–∏–∞–ø–∞–∑–æ–Ω –≤—Ä–µ–º–µ–Ω–∏: **–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è**
4. –í—ã–±—Ä–∞—Ç—å: ‚úÖ –§–∞–π–ª—ã cookie –∏ –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–∞–π—Ç–æ–≤
5. –û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ

**Safari:**
1. Safari ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å
2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ –≤–µ–±-—Å–∞–π—Ç–æ–≤
3. –ù–∞–π—Ç–∏ `training.nubofit.ru`
4. –£–¥–∞–ª–∏—Ç—å

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### 1. –û—Ç–∫—Ä—ã—Ç—å DevTools ‚Üí Network

1. –û—Ç–∫—Ä—ã—Ç—å `training.nubofit.ru`
2. `F12` ‚Üí **Network** tab
3. ‚úÖ **Disable cache** (–≥–∞–ª–æ—á–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞!)
4. –û—Ç–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–í—ã–±–µ—Ä–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ"
5. –ù–∞–π—Ç–∏ –∑–∞–ø—Ä–æ—Å –∫ `/api/exercises/translated`
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞:

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```
Cache-Control: no-store, no-cache, must-revalidate, proxy-revalidate
Pragma: no-cache
Expires: 0
```

**–†–∞–∑–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:** ~150-200 KB (–¥–ª—è 92 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π)

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞

1. `F12` ‚Üí **Console** tab
2. –û—á–∏—Å—Ç–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å
3. –û—Ç–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–í—ã–±–µ—Ä–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ"
4. –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ:

```
‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ 92 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –∏–∑ API (–±–µ–∑ –∫—ç—à–∞)
‚úÖ ExercisePicker: –ó–∞–≥—Ä—É–∂–µ–Ω–æ 92 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
```

‚ùå **–ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```
‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ 107 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º fallback: 5 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞

- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: **"–í—ã–±–µ—Ä–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ (92)"** –ø—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–µ "–í—Å–µ"
- –ü—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–µ "–ì—Ä—É–¥—å": **(9)**
- –ü—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–µ "–ù–æ–≥–∏": **(19)**
- –ü—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–µ "–ü—Ä–µ—Å—Å": **(22)**

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –í—Å–µ –µ—â–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 107

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –¥–µ–ø–ª–æ–π –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ:
   ```bash
   curl https://training.nubofit.ru/api/exercises/translated 2>/dev/null | grep -o '"id"' | wc -l
   # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: 92
   ```

2. –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å–∞–π—Ç–∞ (–°–ø–æ—Å–æ–± 1 –≤—ã—à–µ)

3. –û—Ç–∫—Ä—ã—Ç—å –≤ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ

4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è JS:
   - DevTools ‚Üí Network ‚Üí –ù–∞–π—Ç–∏ `main-*.js`
   - –†–∞–∑–º–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥—Ä—É–≥–∏–º

---

### –ü—Ä–æ–±–ª–µ–º–∞: –í –∫–æ–Ω—Å–æ–ª–∏ "‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º fallback: 5 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π"

**–ü—Ä–∏—á–∏–Ω–∞:** API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ API —Ä–∞–±–æ—Ç–∞–µ—Ç:
   ```bash
   curl https://training.nubofit.ru/api/exercises/translated
   ```

2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
   ```bash
   ls -lh ~/webapptraining/data/custom-exercises-ru.json
   cat ~/webapptraining/data/custom-exercises-ru.json | grep '"id"' | wc -l
   ```

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å PM2:
   ```bash
   pm2 restart all
   pm2 logs
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞: Hard Reload –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç

**–ü—Ä–∏—á–∏–Ω–∞:** Hard Reload –Ω–µ –æ—á–∏—â–∞–µ—Ç localStorage –∏ indexedDB

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–°–ø–æ—Å–æ–± 1** (Clear site data)
- –ò–ª–∏ –≤—Ä—É—á–Ω—É—é –æ—á–∏—Å—Ç–∏—Ç—å:
  1. F12 ‚Üí Application ‚Üí Local Storage ‚Üí `training.nubofit.ru` ‚Üí Clear
  2. F12 ‚Üí Application ‚Üí IndexedDB ‚Üí –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –±–∞–∑—ã
  3. F12 ‚Üí Application ‚Üí Service Workers ‚Üí Unregister

---

### –ü—Ä–æ–±–ª–µ–º–∞: –í Network –≤–∏–∂—É —Å—Ç–∞—Ä—ã–π Cache-Control

**–ü—Ä–∏—á–∏–Ω–∞:** –ë—Ä–∞—É–∑–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –í DevTools ‚Üí Network ‚Üí ‚úÖ **Disable cache**
2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
3. –ó–∞–Ω–æ–≤–æ –æ—Ç–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –Ω–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚ùå 107 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π (—Å –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏)
- ‚ùå –î–∞–Ω–Ω—ã–µ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 1 —á–∞—Å
- ‚ùå Hard reload –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ 92 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è (–±–µ–∑ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å–≤–µ–∂–∏–µ –∫–∞–∂–¥—ã–π —Ä–∞–∑
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å–∞–π—Ç–∞ –ø–æ–º–æ–≥–∞–µ—Ç

---

## üéØ –§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç

- [ ] `git pull origin main` –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] `npm run build` —É—Å–ø–µ—à–Ω–æ
- [ ] `pm2 restart all` –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 92 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
- [ ] –ó–∞–≥–æ–ª–æ–≤–∫–∏ API: `Cache-Control: no-cache`
- [ ] **–î–∞–Ω–Ω—ã–µ —Å–∞–π—Ç–∞ –æ—á–∏—â–µ–Ω—ã (F12 ‚Üí Clear site data)**
- [ ] –í –∫–æ–Ω—Å–æ–ª–∏: "–ó–∞–≥—Ä—É–∂–µ–Ω–æ 92 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π"
- [ ] –í –∑–∞–≥–æ–ª–æ–≤–∫–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞: "(92)"
- [ ] –ù–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π

---

**‚ú® –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ 92 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è!**

